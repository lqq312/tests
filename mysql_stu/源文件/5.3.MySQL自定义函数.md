[TOC]

# 概述

* 与存储过程非常类似，但是必须带有返回值；
* 与内置的SUM()，MAX()等原生函数的使用方法类似；
  * SELECT func(val);
  * SELECT * FROM tbl WHERE col=func(val);
* 自定义函数可能在遍历每条记录中使用，但会有性能损耗。

## 语法

```
CREATE
	[DEFINER = {user | CURRENT_USER}]
	FUNCTION sp_name ([func_parameter [,...]])
	RETURNS TYPE
	[characteristic ...] routine_body

func_parameter:
	param_name TYPE

TYPE:
	Any valid MySQL data type

characteristic:
	COMMENT 'string'
	| [NOT] DETERMINISTIC

routine_body:
	Valid SQL routine statement
```



## 示例

```
DELIMITER //
CREATE FUNCTION func_test1 (total INT)
RETURNS INT
BEGIN
	DECLARE i INT;
	DECLARE res INT;
	SET i = 1;
	SET res = 1;
	IF total <= 0 THEN
		SET total = 1;
	END IF;
	WHILE i <= total DO
		SET res = res * i;
		SET i = i + 1;
	END WHILE;
	RETURN res;
END //
DELIMITER ;

mysql> select func_test1(4);
        +---------------+
        | func_test1(4) |
        +---------------+
        |           24  |
        +---------------+
```

